<html>
	<head>
		<title>chat</title>
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/foundation/6.2.1/foundation-flex.min.css">
		<style>
			#chatsystem{
				width:760px;
				margin:0 auto;
				padding:24px;
			}
			#chatbox,#usernames{
				 display:none; 
			}
			body{
				background:#f0f0f0;
			}
			#chat p:nth-child(odd){
				color:red;
			}
		</style>
	</head>
	<body>
		
		<div id="chatsystem">
			<div id="roombox">
				<span>type in your roomname</span>
				<input type="text" id="roomname">
				<button id="roomboxBtn" class="button">submit</button>
			</div>
<!-- 
			<div id="usernamebox">
				<span>type in your nickname</span>
				<input type="text" id="nickname"><br>
				<button id="usernameBtn">submit</button>
			</div> -->
			
			<div id="chatbox" class="row">
				<div class="columns">
					<div id="usernames"></div>
				</div>
				<div class="columns">
					
					<div class="row">
						<div class="columns">
							<div id="chat"></div>
						</div>
						<div class="columns">
							<div id="send-message">
								<input type="text" id="message" size="35">
								<div class="row">
									<div class="columns text-left"><button id="chatboxBtn" class="button">submit</button></div>
									<div class="columns text-right"><button id="leaveRoom" class="button alert" data-room="">leave</button></div>
								</div>
								
								
							</div>
						</div>
					</div>
					
					
				</div>				
			</div>
		</div>
		<div class="clearfix"></div>
		
		
		<!--== <script src="node_modules/jquery/dist/jquery.js"></script> ==-->
		<script src="http://code.jquery.com/jquery-latest.min.js"></script>
		<script src="/socket.io/socket.io.js"></script>

		<script>
		  var socket = io(),
		  $message = $('#message'),
		  $room = $('#roomname'),
		  $roombox = $('#roombox'),
		  $message = $('#message'),
		  $messagebox = $('#chatbox #chatboxBtn');
		  $chat = $('#chat');
		  $chatbox = $('#chatbox');
		  $leaveRoom = $('#leaveRoom');

		 var roomcurrent;

		  $leaveRoom.click(function(){
		  	var x = $leaveRoom.attr('data-room');
		  	console.log(x);
		  	socket.emit('leave room',x);
		  	$chatbox.hide();
		  	$roombox.show();
		  	$chat.html('');
		  });

		  $roombox.on('click','#roomboxBtn',()=> {
		  	roomcurrent = $room.val();
		  	$chatbox.show();
		  	$roombox.hide();
		  	socket.emit('switch room',roomcurrent);
		  	$leaveRoom.attr('data-room',roomcurrent);
		  });

		  $messagebox.click(()=>{
		  	var a = $message.val();
		  	console.log(a);
		  	socket.emit('send message',a,roomcurrent);
		  	$message.val('');
		  });
		  

		  socket.on('new message',function(data){
		  	$chat.append(`<p>${data}</p>`);
		  });

		  socket.on('some event',function(data){
		 	console.log(data);
		 	});
		</script>
	</body>
</html>